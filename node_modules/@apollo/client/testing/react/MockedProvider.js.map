{"version":3,"file":"MockedProvider.js","sourceRoot":"","sources":["../../../src/testing/react/MockedProvider.tsx"],"names":[],"mappings":";AAAA,OAAO,KAAK,KAAK,MAAM,OAAO,CAAC;AAG/B,OAAO,EAAE,YAAY,EAAE,MAAM,YAAY,CAAC;AAC1C,OAAO,EAAE,aAAa,IAAI,KAAK,EAAE,MAAM,aAAa,CAAC;AACrD,OAAO,EAAE,cAAc,EAAE,MAAM,qBAAqB,CAAC;AACrD,OAAO,EAAE,aAAa,EAAE,MAAM,aAAa,CAAC;AAE5C,OAAO,EAAE,QAAQ,EAAE,MAAM,SAAS,CAAC;AAuBnC;IAAoC,kCAGnC;IAKC,wBAAY,KAA0B;;QAAtC,YACE,kBAAM,KAAK,CAAC,SA2Bb;QAxBG,IAAA,KAAK,IADD,KASF,KAAI,CAAC,KAAK,WARP,EACL,WAAW,iBAAA,EACX,cAAc,oBAAA,EACd,KAAK,WAAA,EACL,SAAS,eAAA,EACT,IAAI,UAAA,EACJ,aAAa,mBAAA,EACb,YAAY,kBAAA,CACC;QACf,IAAM,MAAM,GAAG,IAAI,YAAY,CAAC;YAC9B,KAAK,EAAE,KAAK,IAAI,IAAI,KAAK,CAAC,EAAE,WAAW,aAAA,EAAE,CAAC;YAC1C,cAAc,gBAAA;YACd,IAAI,EAAE,IAAI,IAAI,IAAI,QAAQ,CACxB,KAAK,IAAI,EAAE,EACX,WAAW,EACX,EAAE,YAAY,cAAA,EAAE,CACjB;YACD,SAAS,WAAA;SACV,CAAC,CAAC;QAEH,KAAI,CAAC,KAAK,GAAG;YACX,MAAM,QAAA;YACN,aAAa,EAAE,aAAa,IAAI,IAAI,aAAa,EAAE;SACpD,CAAC;;IACJ,CAAC;IAEM,+BAAM,GAAb;;QACU,IAAA,QAAQ,IAAV,KAA2B,IAAI,CAAC,KAAK,cAA3B,EAAE,UAAU,gBAAA,CAAgB;QACpC,IAAA,MAAM,IAAR,KAA4B,IAAI,CAAC,KAAK,YAA9B,EAAE,aAAa,mBAAA,CAAgB;QAE7C,OAAO,KAAK,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CACtC,oBAAC,cAAc,IAAC,MAAM,EAAE,MAAM,EAAE,aAAa,EAAE,aAAa,IACzD,KAAK,CAAC,YAAY,CAAC,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,eAAO,UAAU,EAAG,CACtD,CAClB,CAAC,CAAC,CAAC,IAAI,CAAC;IACX,CAAC;IAEM,6CAAoB,GAA3B;QAGE,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,EAAE,CAAC;IAC3B,CAAC;IAjDa,2BAAY,GAAwB;QAChD,WAAW,EAAE,IAAI;KAClB,CAAC;IAgDJ,qBAAC;CAAA,AAtDD,CAAoC,KAAK,CAAC,SAAS,GAsDlD","sourcesContent":["import * as React from 'react';\n\nimport type { DefaultOptions } from '../../core';\nimport { ApolloClient } from '../../core';\nimport { InMemoryCache as Cache } from '../../cache';\nimport { ApolloProvider } from '../../react/context';\nimport { SuspenseCache } from '../../react';\nimport type { MockedResponse } from '../core';\nimport { MockLink } from '../core';\nimport type { ApolloLink } from '../../link/core';\nimport type { Resolvers } from '../../core';\nimport type { ApolloCache } from '../../cache';\n\nexport interface MockedProviderProps<TSerializedCache = {}> {\n  mocks?: ReadonlyArray<MockedResponse>;\n  addTypename?: boolean;\n  defaultOptions?: DefaultOptions;\n  cache?: ApolloCache<TSerializedCache>;\n  resolvers?: Resolvers;\n  childProps?: object;\n  children?: any;\n  link?: ApolloLink;\n  suspenseCache?: SuspenseCache;\n  showWarnings?: boolean;\n}\n\nexport interface MockedProviderState {\n  client: ApolloClient<any>;\n  suspenseCache: SuspenseCache;\n}\n\nexport class MockedProvider extends React.Component<\n  MockedProviderProps,\n  MockedProviderState\n> {\n  public static defaultProps: MockedProviderProps = {\n    addTypename: true\n  };\n\n  constructor(props: MockedProviderProps) {\n    super(props);\n\n    const {\n      mocks,\n      addTypename,\n      defaultOptions,\n      cache,\n      resolvers,\n      link,\n      suspenseCache,\n      showWarnings,\n    } = this.props;\n    const client = new ApolloClient({\n      cache: cache || new Cache({ addTypename }),\n      defaultOptions,\n      link: link || new MockLink(\n        mocks || [],\n        addTypename,\n        { showWarnings }\n      ),\n      resolvers,\n    });\n\n    this.state = {\n      client,\n      suspenseCache: suspenseCache || new SuspenseCache()\n    };\n  }\n\n  public render() {\n    const { children, childProps } = this.props;\n    const { client, suspenseCache } = this.state;\n\n    return React.isValidElement(children) ? (\n      <ApolloProvider client={client} suspenseCache={suspenseCache}>\n        {React.cloneElement(React.Children.only(children), { ...childProps })}\n      </ApolloProvider>\n    ) : null;\n  }\n\n  public componentWillUnmount() {\n    // Since this.state.client was created in the constructor, it's this\n    // MockedProvider's responsibility to terminate it.\n    this.state.client.stop();\n  }\n}\n"]}